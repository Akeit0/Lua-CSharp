{
  "name": "lua-csharp-vscode-debug",
  "displayName": "Lua-CSharp Debugger",
  "description": "Debug Lua scripts running on the Lua-CSharp runtime.",
  "version": "0.0.1",
  "publisher": "local",
  "private": true,
  "engines": {
    "vscode": "^1.94.0"
  },
  "categories": [
    "Debuggers"
  ],
  "main": "./dist/extension.js",
  "activationEvents": [
    "onDebugResolve:lua-csharp",
    "onCommand:lua-csharp.showBytecode",
    "onCommand:lua-csharp.debugOptions",
    "onCommand:lua-csharp.findPrototypeAtCursor",
    "onLanguage:lua"
  ],
  "contributes": {
    "configuration": {
      "title": "Lua-CSharp",
      "properties": {
        "luaCsharp.bytecodeViewer.openOnStop": {
          "type": "boolean",
          "default": false,
          "markdownDescription": "If true, automatically opens the Bytecode Viewer when the debugger stops. When false, open it via the 'Lua: Show Bytecode' command."
        }
      }
    },
    "commands": [
      {
        "command": "lua-csharp.showBytecode",
        "title": "Lua: Bytecode Viewer",
        "category": "Lua-CSharp"
      },
      {
        "command": "lua-csharp.debugOptions",
        "title": "Lua: Debugger Options",
        "category": "Lua-CSharp"
      },
      {
        "command": "lua-csharp.findPrototypeAtCursor",
        "title": "Lua: Find Prototype At Cursor",
        "category": "Lua-CSharp"
      }
    ],
    "debuggers": [
      {
        "type": "lua-csharp",
        "label": "Lua-CSharp",
        "languages": ["lua"],
        "program": "./dist/extension.js",
        "configurationAttributes": {
          "launch": {
            "required": ["program"],
            "properties": {
              "program": {
                "type": "string",
                "description": "Path to the Lua script to debug.",
                "default": "${workspaceFolder}/test.lua"
              },
              "cwd": {
                "type": "string",
                "description": "Working directory for the debug target.",
                "default": "${workspaceFolder}"
              },
              "stopOnEntry": {
                "type": "boolean",
                "description": "Break on entry to the program.",
                "default": true
              }
            }
          },
          "attach": {
            "required": ["host", "port"],
            "properties": {
              "host": {
                "type": "string",
                "description": "Host to connect to the running Lua-CSharp Debug Server.",
                "default": "127.0.0.1"
              },
              "port": {
                "type": "number",
                "description": "Port for the Lua-CSharp Debug Server (TCP).",
                "default": 4711
              },
              "program": {
                "type": "string",
                "description": "Optional: Lua script to launch after breakpoints are set.",
                "default": ""
              },
              "cwd": {
                "type": "string",
                "description": "Optional: Working directory for the program when launching via attach.",
                "default": ""
              },
              "stopOnEntry": {
                "type": "boolean",
                "description": "Optional: Break on entry when launching via attach.",
                "default": true
              }
            }
          }
        },
        "initialConfigurations": [
          {
            "name": "Lua-CSharp: Launch",
            "type": "lua-csharp",
            "request": "launch",
            "program": "${workspaceFolder}/test.lua",
            "cwd": "${workspaceFolder}",
            "stopOnEntry": true
          },
          {
            "name": "Lua-CSharp: Attach (TCP)",
            "type": "lua-csharp",
            "request": "attach",
            "host": "127.0.0.1",
            "port": 4711
          }
        ]
      }
    ]
  },
  "scripts": {
    "compile": "node ./scripts/build.mjs",
    "build": "npm run compile",
    "watch": "node ./scripts/build.mjs --watch",
    "vscode:prepublish": "npm run compile",
    "package": "vsce package"
  },
  "devDependencies": {
    "@types/node": "^20.11.30",
    "@types/vscode": "^1.94.0",
    "@vscode/debugadapter": "^1.68.0",
    "@vscode/debugprotocol": "^1.68.0",
    "esbuild": "^0.21.0",
    "vsce": "^2.15.0"
  }
}
